#!/bin/bash

# Скрипт для поиска заданного слова в заданном файле
# Файл и слово передаются как аргументы командной строки

# Проверяем, что передано ровно два аргумента
if [ "$#" -ne 2 ]; then
  echo "Использование: $0 <имя_файла> <слово_для_поиска>"
  echo "Пример: $0 config.txt path"
  exit 1 # Выход с кодом ошибки неверного использования
fi

# Присваиваем аргументы переменным для читаемости
FILENAME="$1"
SEARCH_WORD="$2"

echo "--- Поиск слова '$SEARCH_WORD' в файле '$FILENAME' (параметры Bash) ---"

# Проверяем, существует ли файл
if [ ! -f "$FILENAME" ]; then
  echo "Ошибка: Файл '$FILENAME' не найден."
  exit 1 # Выход с кодом ошибки
fi

# Проверяем, доступен ли файл для чтения
if [ ! -r "$FILENAME" ]; then
    echo "Ошибка: Файл '$FILENAME' не доступен для чтения (проверьте права)."
    exit 1 # Выход с кодом ошибки
fi

# Используем grep для поиска строк, содержащих слово
# Опция -n добавит номер строки
# Опция --color=auto подсветит найденное слово
grep -n --color=auto "$SEARCH_WORD" "$FILENAME"

# Проверяем статус выхода grep
# 0 = найдено хотя бы одно совпадение
# 1 = совпадений не найдено
# >1 = ошибка (например, файл не найден, хотя мы это проверили ранее)
GREP_EXIT_STATUS=$?

if [ $GREP_EXIT_STATUS -eq 1 ]; then
    echo "Слово '$SEARCH_WORD' не найдено в файле '$FILENAME'."
fi

echo "--- Поиск завершен ---"

# Выходим с тем же кодом, что и grep (0 если найдено, 1 если не найдено)
exit $GREP_EXIT_STATUS